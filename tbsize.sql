SET LINESIZE 200

SET PAGESIZE 1000


SELECT

 A.TABLESPACE_NAME "TBS_NAME",

 ROUND(SUM(A.BYTES) / (1024*1024)) || 'M' "TOTAL",

 ROUND(SUM(B.FREES) / (1024*1024)) || 'M' "FREE"

FROM

 (

  SELECT FILE_ID, TABLESPACE_NAME, SUM(BYTES) BYTES

  FROM DBA_DATA_FILES

  GROUP BY FILE_ID, TABLESPACE_NAME

 ) A,

 (

  SELECT TABLESPACE_NAME, FILE_ID, SUM(BYTES) FREES

  FROM DBA_FREE_SPACE

  GROUP BY TABLESPACE_NAME, FILE_ID

 ) B

WHERE

 A.TABLESPACE_NAME=B.TABLESPACE_NAME AND

 A.FILE_ID=B.FILE_ID

GROUP BY A.TABLESPACE_NAME

ORDER BY A.TABLESPACE_NAME;
